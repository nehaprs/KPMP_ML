# Unsupervised integration of biomarker and clinical KPMP data to reveal subtypes of chronic kidney disease

Chronic Kidney Disease(CKD) is characterized by gradual loss of the kidney's ability to filter waste from the blood. 
In this project, we combine clinical and biomarker data of patients diagnosed with CKD to classify the various subtypes of the disease.

---

##  Overview

This repository contains all scripts, configuration files, and documentation for the analysis.  
It is designed for reproducibility, modularity, and clarity. The analysis is performed using Python.

---

##  Repository Structure:
```

├── scripts/ 
├── results/ 
├── environment.yml 
├── config.yaml 
├── LICENSE 
└── README.md 
```
---

##  Setup

1. **Clone the repository:**
 ```
   
   git clone https://github.com/nehaprs/KPMP_ML.git
   cd KPMP_ML
```
Create and activate the conda environment:
```
conda env create -f environment.yml
conda activate environment.yml
```
---

## Analysis Workflow:

**Data**:
The data used in this study can be obtained from the publicly available clinaical and biomarker data from the [Kidney Precision Medicine Project](https://www.kpmp.org/).

[Clinical data](https://atlas.kpmp.org/repository/?size=n_20_n&filters%5B0%5D%5Bfield%5D=access&filters%5B0%5D%5Bvalues%5D%5B0%5D=open&filters%5B0%5D%5Btype%5D=any&filters%5B1%5D%5Bfield%5D=data_category&filters%5B1%5D%5Bvalues%5D%5B0%5D=Clinical&filters%5B1%5D%5Btype%5D=any)

[Biomarker Data](https://atlas.kpmp.org/repository/?size=n_20_n&filters%5B0%5D%5Bfield%5D=access&filters%5B0%5D%5Bvalues%5D%5B0%5D=open&filters%5B0%5D%5Btype%5D=any&filters%5B1%5D%5Bfield%5D=data_category&filters%5B1%5D%5Bvalues%5D%5B0%5D=Biomarker&filters%5B1%5D%5Btype%5D=any&sort%5B0%5D%5Bfield%5D=workflow_type&sort%5B0%5D%5Bdirection%5D=asc)
(Plasma and Urine Biomarker Data were considered for this study.)

 **Data Preparation and Feature Filtering**
 - Import Datasets from the public repositories linked above
 - Extract clinical, plasma biomarker, and urine biomarker information of participants with CKD from all the datasets:
   https://github.com/nehaprs/KPMP_ML/blob/main/scripts/01_consolidate_data.ipynb
 - Consolidate all the datasets, select for the first appointment per patient, and remove features without biological   relevance:
    https://github.com/nehaprs/KPMP_ML/blob/main/scripts/02_combine_and_clean.ipynb
 - Further Data Preprocessing: imputation, normalization, scaling etc:
      https://github.com/nehaprs/KPMP_ML/blob/main/scripts/03_preprocessing_kmeans_clustering.ipynb
   
**Model Building**
- Unsupervised learning using k-means clustering.
- Model evaluation with silhouette score and Davies-Bouldin Index:
   https://github.com/nehaprs/KPMP_ML/blob/main/scripts/03_preprocessing_kmeans_clustering.ipynb
<img width="567" height="455" alt="silhouette" src="https://github.com/user-attachments/assets/c0714fe5-9771-42fd-8891-979c79c7bf4c" />
  *Figure 1: silhouette plot*
  
<img width="567" height="455" alt="DBI" src="https://github.com/user-attachments/assets/34d0d79e-75dd-4603-b934-2586c785134e" />
 *Figure 2: Davis-Bouldin Index plotted*

 
**Visualization and Results**
   - 2 clusters of CKD patients obtained: one with 192 participants and another with 14 participants.
   
Save all outputs to the results/ directory.


Dependencies:
All dependencies are managed through environment.yml.



License:
This project is licensed under the MIT License.





For questions or contributions, please contact nehaprs@udel.edu, julngu@udel.edu, or svalipou@udel.edu 


---

The results here are in whole or part based upon data generated by the Kidney Precision Medicine Project. Accessed October 19, 2025. https://www.kpmp.org.

The Kidney Precision Medicine Project (KPMP) is supported by the National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK) through the following grants: U01DK133081, U01DK133091, U01DK133092, U01DK133093, U01DK133095, U01DK133097, U01DK114866, U01DK114908, U01DK133090, U01DK133113, U01DK133766, U01DK133768, U01DK114907, U01DK114920, U01DK114923, U01DK114933, U24DK114886, UH3DK114926, UH3DK114861, UH3DK114915, and UH3DK114937. We gratefully acknowledge the essential contributions of our patient participants and the support of the American public through their tax dollars.

‍

